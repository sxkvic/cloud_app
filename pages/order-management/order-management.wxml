<view class="order-management-container">
  <!-- Tab 切换 -->
  <view class="tabs-container">
    <view class="tabs">
      <view 
        class="tab-item {{activeTab === 'package' ? 'active' : ''}}" 
        bindtap="switchTab" 
        data-tab="package"
      >
        <text class="tab-text">套餐订购</text>
        <view class="tab-indicator" wx:if="{{activeTab === 'package'}}"></view>
      </view>
      <view 
        class="tab-item {{activeTab === 'recharge' ? 'active' : ''}}" 
        bindtap="switchTab" 
        data-tab="recharge"
      >
        <text class="tab-text">预充值订单</text>
        <view class="tab-indicator" wx:if="{{activeTab === 'recharge'}}"></view>
      </view>
    </view>
  </view>

  <!-- 骨架屏 -->
  <view wx:if="{{loading}}" class="skeleton-container">
    <view class="skeleton-item" wx:for="{{[1,2,3,4,5]}}" wx:key="index">
      <view class="skeleton-header">
        <view class="skeleton-line skeleton-title"></view>
        <view class="skeleton-line skeleton-status"></view>
      </view>
      <view class="skeleton-content">
        <view class="skeleton-line skeleton-text"></view>
        <view class="skeleton-line skeleton-text"></view>
        <view class="skeleton-line skeleton-text"></view>
      </view>
      <view class="skeleton-footer">
        <view class="skeleton-line skeleton-amount"></view>
      </view>
    </view>
  </view>

  <!-- 套餐订购列表 -->
  <view wx:if="{{!loading && activeTab === 'package'}}" class="order-list">
    <!-- 空状态 -->
    <view wx:if="{{packageOrders.length === 0}}" class="empty-state">
      <image class="empty-icon" src="/images/empty-order.png" mode="aspectFit"></image>
      <text class="empty-text">暂无套餐订购记录</text>
    </view>

    <!-- 订单列表 -->
    <view wx:else>
      <view class="order-card" wx:for="{{packageOrders}}" wx:key="id">
        <view class="order-header">
          <view class="order-info">
            <text class="order-no">订单号：{{item.order_no}}</text>
            <view class="status-badge status-{{item.payment_status}}">
              {{item.payment_status === 1 ? '待支付' : item.payment_status === 2 ? '已支付' : '已取消'}}
            </view>
          </view>
          <text class="order-time">{{item.order_time}}</text>
        </view>

        <view class="order-content">
          <view class="content-row">
            <text class="label">套餐名称：</text>
            <text class="value">{{item.package_name}}</text>
          </view>
          <view class="content-row">
            <text class="label">套餐类型：</text>
            <text class="value">{{item.package_type === '0' ? '包月' : item.package_type === '1' ? '包年' : '其他'}}</text>
          </view>
          <view class="content-row">
            <text class="label">客户名称：</text>
            <text class="value">{{item.customer_name}}</text>
          </view>
          <view class="content-row">
            <text class="label">设备编号：</text>
            <text class="value">{{item.device_no}}</text>
          </view>
          <view class="content-row">
            <text class="label">充值账号：</text>
            <text class="value">{{item.recharge_account}}</text>
          </view>
          <view class="content-row">
            <text class="label">支付方式：</text>
            <text class="value">{{item.payment_type === 1 ? '微信支付' : item.payment_type === 2 ? '支付宝' : '线下支付'}}</text>
          </view>
          <view class="content-row" wx:if="{{item.payment_time}}">
            <text class="label">支付时间：</text>
            <text class="value">{{item.payment_time}}</text>
          </view>
        </view>

        <view class="order-footer">
          <view class="amount-info">
            <text class="amount-label">订单金额：</text>
            <text class="amount-value">¥{{item.order_amount}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 预充值订单列表 -->
  <view wx:if="{{!loading && activeTab === 'recharge'}}" class="order-list">
    <!-- 空状态 -->
    <view wx:if="{{rechargeOrders.length === 0}}" class="empty-state">
      <image class="empty-icon" src="/images/empty-order.png" mode="aspectFit"></image>
      <text class="empty-text">暂无预充值订单记录</text>
    </view>

    <!-- 订单列表 -->
    <view wx:else>
      <view class="order-card" wx:for="{{rechargeOrders}}" wx:key="id">
        <view class="order-header">
          <view class="order-info">
            <text class="order-no">订单号：{{item.order_no}}</text>
            <view class="status-badge status-{{item.recharge_status}}">
              {{item.recharge_status === 1 ? '待充值' : item.recharge_status === 2 ? '已充值' : '已取消'}}
            </view>
          </view>
          <text class="order-time">{{item.created_at}}</text>
        </view>

        <view class="order-content">
          <view class="content-row">
            <text class="label">客户名称：</text>
            <text class="value">{{item.customer_name}}</text>
          </view>
          <view class="content-row">
            <text class="label">设备编号：</text>
            <text class="value">{{item.device_no}}</text>
          </view>
          <view class="content-row">
            <text class="label">充值账号：</text>
            <text class="value">{{item.recharge_account}}</text>
          </view>
          <view class="content-row">
            <text class="label">支付方式：</text>
            <text class="value">{{item.payment_type === 1 ? '微信支付' : item.payment_type === 2 ? '支付宝' : '线下支付'}}</text>
          </view>
          <view class="content-row" wx:if="{{item.payment_time}}">
            <text class="label">支付时间：</text>
            <text class="value">{{item.payment_time}}</text>
          </view>
          <view class="content-row" wx:if="{{item.remark}}">
            <text class="label">备注：</text>
            <text class="value">{{item.remark}}</text>
          </view>
        </view>

        <view class="order-footer">
          <view class="amount-info">
            <text class="amount-label">充值金额：</text>
            <text class="amount-value">¥{{item.recharge_amount}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 加载更多 -->
  <view wx:if="{{!loading && hasMore}}" class="load-more" bindtap="loadMore">
    <text class="load-more-text">加载更多</text>
  </view>

  <!-- 没有更多 -->
  <view wx:if="{{!loading && !hasMore && (packageOrders.length > 0 || rechargeOrders.length > 0)}}" class="no-more">
    <text class="no-more-text">没有更多了</text>
  </view>
</view>
