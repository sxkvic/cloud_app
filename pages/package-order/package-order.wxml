<!--pages/package-order/package-order.wxml-->
<view class="package-order-page">
    <!-- ÂèØÊªöÂä®ÂÜÖÂÆπÂå∫Âüü -->
    <scroll-view class="content-wrapper" scroll-y enhanced show-scrollbar="{{false}}">
        
        <!-- È™®Êû∂Â±è - Âä†ËΩΩ‰∏≠ÊòæÁ§∫ -->
        <view wx:if="{{ loading }}" class="skeleton-wrapper">
            <view class="skeleton-card" wx:for="{{[1,2,3,4,5]}}" wx:key="*this">
                <view class="skeleton-thumb"></view>
                <view class="skeleton-content">
                    <view class="skeleton-line skeleton-title"></view>
                    <view class="skeleton-line skeleton-desc"></view>
                    <view class="skeleton-tags">
                        <view class="skeleton-tag"></view>
                        <view class="skeleton-tag"></view>
                    </view>
                </view>
            </view>
        </view>
        
        <!-- Â•óÈ§êÂàóË°® - Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫ -->
        <view wx:else class="package-list fade-in">
            <view wx:for="{{ packages }}" wx:key="id" class="package-card {{ selectedPackage === item.id ? 'selected' : '' }}" bindtap="selectPackage" data-id="{{ item.id }}">
                <!-- ÁÉ≠Èó®ËßíÊ†á -->
                <view class="popular-badge" wx:if="{{ item.isPopular }}">ÁâπÊÉ†</view>
                
                <!-- Â∑¶‰æßÊµÅÈáèÂõæÊ†á -->
                <view class="data-thumb theme-{{ item.colorTheme }}">
                    <view class="signal-bg"></view>
                    <view class="data-content">
                        <view class="data-number">
                            <text class="data-num">{{ item.speed }}</text>
                            <text class="data-unit">{{ item.speedUnit }}</text>
                        </view>
                        <view class="data-type">ÂÆΩÂ∏¶</view>
                    </view>
                </view>
                
                <!-- Âè≥‰æß‰ø°ÊÅØ -->
                <view class="package-info">
                    <view class="info-top">
                        <view class="package-header">
                            <view class="package-name">{{ item.name }}</view>
                            <view class="package-price">
                                <text class="price-symbol">¬•</text>
                                <text class="price-value">{{ item.price }}</text>
                            </view>
                        </view>
                        <view class="package-desc" wx:if="{{ item.features.length > 0 }}">{{ item.features[0] }}</view>
                        
                        <!-- ÁâπÊÄßÊ†áÁ≠æ -->
                        <view class="feature-tags">
                            <view wx:for="{{ item.featureTags }}" wx:for-item="tag" wx:key="*this" class="feature-tag theme-{{ item.colorTheme }}">
                                {{ tag }}
                            </view>
                        </view>
                    </view>
                    
                    <!-- Ë¥≠‰π∞ÊåâÈíÆ -->
                    <view class="buy-button-wrapper">
                        <view class="buy-button theme-{{ item.colorTheme }}">Ë¥≠‰π∞</view>
                    </view>
                </view>
            </view>
        </view>
    </scroll-view>

    <!-- ËÆ¢Ë¥≠ÊåâÈíÆ -->
    <view class="order-section">
        <!-- Êú™ÈÄâÊã©Êó∂ÊòæÁ§∫ÂºïÂØº -->
        <view class="order-guide" wx:if="{{ !selectedPackage }}">
            <text class="guide-icon">üëÜ</text>
            <text class="guide-text">ËØ∑Âú®‰∏äÊñπÈÄâÊã©ÊÇ®ÈúÄË¶ÅÁöÑÂ•óÈ§ê</text>
        </view>

        <!-- Â∑≤ÈÄâÊã©Êó∂ÊòæÁ§∫ÊëòË¶Å -->
        <view class="order-summary" wx:if="{{ selectedPackage && customerInfo }}">
            <view class="summary-row">
                <view class="summary-info">
                    <text class="summary-label">ÂÆ¢Êà∑</text>
                    <text class="summary-value">{{ customerInfo.customer_name || 'Êú™Áü•' }}</text>
                </view>
                <view class="summary-info">
                    <text class="summary-label">Â∑≤ÈÄâÂ•óÈ§ê</text>
                    <text class="summary-value">{{ selectedPackageName }}</text>
                </view>
            </view>
            <view class="summary-divider"></view>
            <view class="summary-price-row">
                <text class="price-label">ÈáëÈ¢ù</text>
                <text class="price-amount">¬•{{ selectedPackagePrice }}</text>
            </view>
        </view>

        <button 
            class="order-button {{ selectedPackage && customerInfo ? 'active' : 'disabled' }}" 
            disabled="{{ !selectedPackage || !customerInfo || submitLoading }}"
            loading="{{ submitLoading }}"
            bindtap="confirmOrder"
        >
            {{ submitLoading ? 'ËÆ¢Ë¥≠‰∏≠...' : (selectedPackage && customerInfo ? 'Á´ãÂç≥ËÆ¢Ë¥≠' : 'ËØ∑ÂÖàÈÄâÊã©Â•óÈ§ê') }}
        </button>
    </view>
</view>