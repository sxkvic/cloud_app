<!--pages/package-order/package-order.wxml-->
<view class="package-order-page">
    <!-- å¯æ»šåŠ¨å†…å®¹åŒºåŸŸ -->
    <scroll-view class="content-wrapper" scroll-y enhanced show-scrollbar="{{false}}">
        
        <!-- éª¨æ¶å± - åŠ è½½ä¸­æ˜¾ç¤º -->
        <view wx:if="{{ loading }}" class="skeleton-wrapper">
            <view class="skeleton-card" wx:for="{{[1,2,3,4,5]}}" wx:key="*this">
                <view class="skeleton-thumb"></view>
                <view class="skeleton-content">
                    <view class="skeleton-line skeleton-title"></view>
                    <view class="skeleton-line skeleton-desc"></view>
                    <view class="skeleton-tags">
                        <view class="skeleton-tag"></view>
                        <view class="skeleton-tag"></view>
                    </view>
                </view>
            </view>
        </view>
        
        <!-- å¥—é¤åˆ—è¡¨ - æ•°æ®åŠ è½½å®Œæˆåæ˜¾ç¤º -->
        <view wx:else class="package-list fade-in">
            <view wx:for="{{ packages }}" wx:key="id" class="package-card {{ selectedPackage === item.id ? 'selected' : '' }}" bindtap="selectPackage" data-id="{{ item.id }}">
                <!-- çƒ­é—¨è§’æ ‡ -->
                <view class="popular-badge" wx:if="{{ item.isPopular }}">ç‰¹æƒ </view>
                
                <!-- å·¦ä¾§æµé‡å›¾æ ‡ -->
                <view class="data-thumb theme-{{ item.colorTheme }}">
                    <view class="signal-bg"></view>
                    <view class="data-content">
                        <view class="data-number">
                            <text class="data-num">{{ item.speed }}</text>
                            <text class="data-unit">{{ item.speedUnit }}</text>
                        </view>
                        <view class="data-type">å®½å¸¦</view>
                    </view>
                </view>
                
                <!-- å³ä¾§ä¿¡æ¯ -->
                <view class="package-info">
                    <view class="info-top">
                        <view class="package-header">
                            <view class="package-name">{{ item.name }}</view>
                            <view class="package-price">
                                <text class="price-symbol">Â¥</text>
                                <text class="price-value">{{ item.price }}</text>
                            </view>
                        </view>
                        <view class="package-desc" wx:if="{{ item.features.length > 0 }}">{{ item.features[0] }}</view>
                        
                        <!-- ç‰¹æ€§æ ‡ç­¾ -->
                        <view class="feature-tags">
                            <view wx:for="{{ item.featureTags }}" wx:for-item="tag" wx:key="*this" class="feature-tag theme-{{ item.colorTheme }}">
                                {{ tag }}
                            </view>
                        </view>
                    </view>
                    
                    <!-- è´­ä¹°æŒ‰é’® -->
                    <view class="buy-button-wrapper">
                        <view class="buy-button theme-{{ item.colorTheme }}">è´­ä¹°</view>
                    </view>
                </view>
            </view>
        </view>
    </scroll-view>

    <!-- è®¢è´­æŒ‰é’® -->
    <view class="order-section">
        <button 
            class="order-button {{ selectedPackage && customerInfo ? 'active' : 'disabled' }}" 
            disabled="{{ !selectedPackage || !customerInfo || submitLoading }}"
            loading="{{ submitLoading }}"
            bindtap="confirmOrder"
        >
            {{ submitLoading ? 'è®¢è´­ä¸­...' : (selectedPackage && customerInfo ? 'ç«‹å³è®¢è´­' : 'è¯·å…ˆé€‰æ‹©å¥—é¤') }}
        </button>
    </view>

    <!-- æ”¯ä»˜æ–¹å¼é€‰æ‹©å¼¹çª— -->
    <view class="payment-modal" wx:if="{{ showPaymentModal }}" catchtap="closePaymentModal">
        <view class="payment-content" catchtap="stopPropagation">
            <view class="payment-header">
                <text class="payment-title">é€‰æ‹©æ”¯ä»˜æ–¹å¼</text>
                <text class="payment-close" catchtap="closePaymentModal">âœ•</text>
            </view>
            <view class="payment-options">
                <view class="payment-option" catchtap="selectPaymentMethod" data-method="wechat">
                    <view class="option-icon wechat-icon">ğŸ’³</view>
                    <view class="option-info">
                        <text class="option-name">å¾®ä¿¡æ”¯ä»˜</text>
                        <text class="option-desc">ä½¿ç”¨å¾®ä¿¡ä½™é¢æˆ–ç»‘å®šé“¶è¡Œå¡æ”¯ä»˜</text>
                    </view>
                    <view class="option-arrow">â€º</view>
                </view>
                <view class="payment-option" catchtap="selectPaymentMethod" data-method="qrcode">
                    <view class="option-icon qrcode-icon">ğŸ“±</view>
                    <view class="option-info">
                        <text class="option-name">å¾®ä¿¡äºŒç»´ç æ”¯ä»˜</text>
                        <text class="option-desc">ç”ŸæˆäºŒç»´ç ï¼Œä½¿ç”¨å¾®ä¿¡æ‰«ç æ”¯ä»˜</text>
                    </view>
                    <view class="option-arrow">â€º</view>
                </view>
                <view class="payment-option" catchtap="selectPaymentMethod" data-method="offline">
                    <view class="option-icon offline-icon">ğŸª</view>
                    <view class="option-info">
                        <text class="option-name">çº¿ä¸‹æ”¯ä»˜</text>
                        <text class="option-desc">åˆ°è¥ä¸šå…æˆ–æŒ‡å®šåœ°ç‚¹æ”¯ä»˜</text>
                    </view>
                    <view class="option-arrow">â€º</view>
                </view>
            </view>
        </view>
    </view>
</view>