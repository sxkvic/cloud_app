<!--pages/bind-device-code/bind-device-code.wxml-->
<view class="container">
  
  <!-- 1. 顶部沉浸式 Header -->
  <view class="header-bg">
    <!-- 装饰背景图 (CSS绘制的Logo C形) -->
    <view class="bg-decoration"></view>

    <!-- 状态栏占位 (防止内容被手机状态栏遮挡) -->
    <view style="height: {{statusBarHeight}}px;"></view>

    <!-- 导航栏区域 -->
    <view class="nav-bar">
      <view class="nav-title"></view>
    </view>

    <!-- 页面大标题 -->
    <view class="header-content">
      <text class="title">绑定设备</text>
      <text class="subtitle">Bind Device to activate network</text>
    </view>
  </view>

  <!-- 2. 悬浮内容区 -->
  <view class="content-body">
    
    <!-- 白色卡片 -->
    <view class="card">
      
      <!-- 扫码区域 -->
      <view class="scan-box" bindtap="handleScan">
        <view class="scan-icon-wrapper">
          <!-- 扫描图标 (SVG Base64) -->
          <image class="icon-scan" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNEQ2QUZGIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTEyIDR2MW02IDExaDJtLTYgMGgtMnY0bTAtMTF2M20wIDBoLjAxTTEyIDE3aC4wMU0xOS4wNyA0LjkzTTE3IDdsMS4wNyAxbS0zLjE0IDBsMS4wNyAxLjA3TTQuOTMgMTkuMDdsMi4wNy0yLjA3bS0zLjE0IDBsMS4wNy0xLjA3Ii8+PC9zdmc+" mode="aspectFit"></image>
          <!-- 扫描线动效 -->
          <view class="scan-line"></view>
        </view>
        <view class="scan-text-box">
          <text class="scan-title">点击扫描二维码/条形码</text>
          <text class="scan-desc">请扫描设备背面的设备码</text>
        </view>
      </view>

      <!-- 分割线 -->
      <view class="divider">
        <view class="line"></view>
        <text class="divider-text">手动输入</text>
        <view class="line"></view>
      </view>

      <!-- 表单输入 -->
      <view class="form-group">
        
        <!-- SN 输入 -->
        <view class="input-item">
          <text class="label">设备编码</text>
          <view class="input-wrapper">
            <input 
              class="input-field font-code" 
              placeholder="请输入设备编码" 
              placeholder-class="input-placeholder"
              value="{{deviceCode}}"
              bindinput="onInputChange"
              maxlength="10"
            />
            <!-- 输入框右侧图标 -->
            <image class="input-icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjRDFEMT1EIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTkgMTJsMiAyIDQtNG06IDJhOSA5IDAgMTEtMTggMCA5IDkgMCAwMTE4IDB6Ii8+PC9zdmc+" mode="aspectFit"></image>
          </view>
        </view>

        <!-- 充值账号输入 -->
        <view class="input-item">
          <text class="label">缴费账号</text>
          <view class="input-wrapper">
            <input 
              class="input-field" 
              type="number"
              placeholder="请输入缴费账号" 
              placeholder-class="input-placeholder"
              value="{{rechargeAccount}}"
              bindinput="onRechargeAccountChange"
              maxlength="10"
            />
            <!-- 输入框右侧图标 -->
            <image class="input-icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjRDFEMT1EIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTUgNGgxNGEyIDIgMCAwMTIgMnYxNGEyIDIgMCAwMS0yIDJINWEyIDIgMCAwMS0yLTJWNmEyIDIgMCAwMTItMnptOCA1djZtLTMtM2g2Ii8+PC9zdmc+" mode="aspectFit"></image>
          </view>
        </view>

      </view>

      <!-- 按钮组 -->
      <view class="btn-group">
        <button 
          class="btn-primary {{isLoading ? 'loading' : ''}}" 
          bindtap="onManualSubmit"
          disabled="{{isLoading}}"
        >
          {{isLoading ? '绑定中...' : '立即绑定设备'}}
        </button>
        <button class="btn-ghost" bindtap="skipBinding">
          暂不绑定，跳过
          <text class="arrow-right">></text>
        </button>
      </view>

    </view>

    <!-- 底部客服 -->
    <view class="footer-link" bindtap="showHelp">
      <text>遇到问题？联系客服</text>
    </view>

    <!-- 底部Logo -->
    <view class="footer-logo">
      <image src="/images/logo2.png" mode="aspectFit"></image>
    </view>

  </view>
  
  <!-- 客服选择弹窗 -->
  <view class="contact-modal" wx:if="{{showContactModal}}" catchtouchmove="true">
    <view class="modal-mask" bindtap="hideContactModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <view class="modal-title">联系客服</view>
      </view>
      <view class="modal-buttons">
        <!-- 在线客服 -->
        <button class="contact-card main-contact btn-reset" open-type="contact" hover-class="card-hover">
          <view class="contact-card-left">
            <view class="contact-title-row">
              <text class="contact-title">在线客服</text>
              <view class="live-badge">在线</view>
            </view>
            <text class="contact-desc">7x24小时 智能+人工服务</text>
          </view>
          <view class="action-icon-box blue-gradient">
            <van-icon name="service-o" size="28px" color="#ffffff" />
          </view>
        </button>
        <!-- 电话热线 -->
        <view class="contact-card sub-contact" hover-class="card-hover" bindtap="callPhone">
          <view class="contact-card-left">
            <text class="sub-contact-label">客服热线</text>
            <text class="hotline-number">4009677726</text>
          </view>
          <view class="call-btn">
            <image class="call-icon" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzRENkFGRiIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNNi42MiAxMC43OWMxLjQ0IDIuODMgMy43NiA1LjE0IDYuNTkgNi41OWwyLjItMi4yYy4yNy0uMjcuNjctLjM2IDEuMDItLjI0IDEuMTIuMzcgMi4zMy41NyAzLjU3LjU3LjU1IDAgMSAuNDUgMSAxVjIxYzAgLjU1LS40NSAxLTEgMS0xMC4wMSAwLTE4LTcuOTktMTgtMTggMC0uNTUuNDUtMSAxLTFoMy41Yy41NSAwIDEgLjQ1IDEgMSAwIDEuMjUuMiAyLjQ1LjU3IDMuNTcuMTEuMzUuMDMuNzQtLjI1IDEuMDJsLTIuMiAyLjJ6Ii8+PC9zdmc+" mode="aspectFit"></image>
            <text>呼叫</text>
          </view>
        </view>
      </view>
      
      <!-- 设备编码查找提示 -->
      <view class="modal-tips">
        <text class="modal-tips-title">找不到设备编码和缴费账号？</text>
        <view class="modal-tips-list">
          <view class="modal-tips-item">
            <text class="modal-tips-number">1.</text>
            <text class="modal-tips-content">请查看设备底部或背面标签</text>
          </view>
          <view class="modal-tips-item">
            <text class="modal-tips-number">2.</text>
            <text class="modal-tips-content">联系当时安装受理的工作人员</text>
          </view>
          <view class="modal-tips-item">
            <text class="modal-tips-number">3.</text>
            <text class="modal-tips-content">查看设备包装盒上面设备编码</text>
          </view>
        </view>
      </view>
      
      <view class="modal-close" bindtap="hideContactModal">取消</view>
    </view>
  </view>
</view>

