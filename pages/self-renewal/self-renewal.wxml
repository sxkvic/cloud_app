<!--pages/self-renewal/self-renewal.wxml-->
<view class="self-renewal-page">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="page-title">è‡ªåŠ©ç»­è´¹</text>
    <text class="page-subtitle">å®½å¸¦æœåŠ¡ç»­è´¹ç®¡ç†</text>
  </view>

  <!-- æœåŠ¡çŠ¶æ€ -->
  <view class="service-status">
    <view class="status-card">
      <view class="status-info">
        <view class="service-icon">ğŸ“¡</view>
        <view class="service-details">
          <text class="service-name">å®¶åº­å®½å¸¦ 100M</text>
          <text class="service-status-text">æœåŠ¡æ­£å¸¸</text>
        </view>
      </view>
      <view class="expiry-info">
        <text class="expiry-label">åˆ°æœŸæ—¶é—´</text>
        <text class="expiry-date">{{ expiryDate }}</text>
      </view>
    </view>
  </view>

  <!-- ç»­è´¹å¥—é¤é€‰æ‹© -->
  <view class="renewal-packages">
    <view class="section-title">ç»­è´¹å¥—é¤</view>
    <view class="package-list">
      <view 
        class="package-item {{ selectedPackage === item.id ? 'selected' : '' }}"
        wx:for="{{ renewalPackages }}"
        wx:key="id"
        bindtap="selectPackage"
        data-id="{{ item.id }}"
      >
        <view class="package-header">
          <view class="package-name">{{ item.name }}</view>
          <view class="package-price">Â¥{{ item.price }}</view>
        </view>
        <view class="package-details">
          <view class="detail-item">
            <text class="detail-label">å¸¦å®½</text>
            <text class="detail-value">{{ item.bandwidth }}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">æ—¶é•¿</text>
            <text class="detail-value">{{ item.duration }}</text>
          </view>
          <view class="detail-item" wx:if="{{ item.bonus }}">
            <text class="detail-label">ä¼˜æƒ </text>
            <text class="detail-value bonus">{{ item.bonus }}</text>
          </view>
        </view>
        <view class="package-radio {{ selectedPackage === item.id ? 'selected' : '' }}">
          <view class="radio-inner"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»­è´¹æ—¶é•¿é€‰æ‹© -->
  <view class="renewal-duration" wx:if="{{ selectedPackage }}">
    <view class="section-title">ç»­è´¹æ—¶é•¿</view>
    <view class="duration-options">
      <view 
        class="duration-item {{ selectedDuration === item.value ? 'selected' : '' }}"
        wx:for="{{ durationOptions }}"
        wx:key="value"
        bindtap="selectDuration"
        data-value="{{ item.value }}"
      >
        <view class="duration-text">{{ item.label }}</view>
        <view class="duration-discount" wx:if="{{ item.discount }}">{{ item.discount }}</view>
      </view>
    </view>
  </view>

  <!-- æ”¯ä»˜æ–¹å¼ -->
  <view class="payment-methods" wx:if="{{ selectedPackage && selectedDuration }}">
    <view class="section-title">æ”¯ä»˜æ–¹å¼</view>
    <view class="method-list">
      <view 
        class="method-item {{ selectedMethod === item.id ? 'selected' : '' }}"
        wx:for="{{ paymentMethods }}"
        wx:key="id"
        bindtap="selectPaymentMethod"
        data-id="{{ item.id }}"
      >
        <view class="method-icon">
          <image wx:if="{{ item.icon === 'wechat' }}" class="payment-icon" src="/images/wechat-pay.svg" mode="aspectFit"></image>
          <image wx:elif="{{ item.icon === 'alipay' }}" class="payment-icon" src="/images/alipay.svg" mode="aspectFit"></image>
          <text wx:else class="payment-emoji">ğŸ’°</text>
        </view>
        <view class="method-info">
          <view class="method-name">{{ item.name }}</view>
          <view class="method-description">{{ item.description }}</view>
        </view>
        <view class="method-radio {{ selectedMethod === item.id ? 'selected' : '' }}">
          <view class="radio-inner"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»­è´¹è¯´æ˜ -->
  <view class="renewal-notice">
    <view class="section-title">ç»­è´¹è¯´æ˜</view>
    <view class="notice-list">
      <view class="notice-item">
        <text class="notice-icon">â°</text>
        <text class="notice-text">ç»­è´¹åæœåŠ¡ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€ç­‰å¾…</text>
      </view>
      <view class="notice-item">
        <text class="notice-icon">ğŸ’°</text>
        <text class="notice-text">æ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼ï¼Œå®‰å…¨ä¾¿æ·</text>
      </view>
      <view class="notice-item">
        <text class="notice-icon">ğŸ“±</text>
        <text class="notice-text">ç»­è´¹æˆåŠŸåå°†å‘é€çŸ­ä¿¡é€šçŸ¥</text>
      </view>
      <view class="notice-item">
        <text class="notice-icon">ğŸ”„</text>
        <text class="notice-text">å¯éšæ—¶æŸ¥çœ‹ç»­è´¹è®°å½•å’Œåˆ°æœŸæ—¶é—´</text>
      </view>
    </view>
  </view>

  <!-- ç»­è´¹è®°å½• -->
  <view class="renewal-history">
    <view class="section-title">ç»­è´¹è®°å½•</view>
    <view class="history-list">
      <view 
        class="history-item"
        wx:for="{{ renewalHistory }}"
        wx:key="id"
      >
        <view class="history-info">
          <view class="history-date">{{ item.date }}</view>
          <view class="history-package">{{ item.package }}</view>
        </view>
        <view class="history-amount">Â¥{{ item.amount }}</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œ -->
  <view class="bottom-actions">
    <view class="payment-summary">
      <view class="summary-item">
        <text class="summary-label">å¥—é¤è´¹ç”¨</text>
        <text class="summary-value">Â¥{{ packagePrice }}</text>
      </view>
      <view class="summary-item" wx:if="{{ discountAmount > 0 }}">
        <text class="summary-label">ä¼˜æƒ é‡‘é¢</text>
        <text class="summary-value discount">-Â¥{{ discountAmount }}</text>
      </view>
      <view class="summary-item total">
        <text class="summary-label">åº”ä»˜é‡‘é¢</text>
        <text class="summary-value">Â¥{{ finalAmount }}</text>
      </view>
    </view>
    
    <view class="action-buttons">
      <button class="action-button secondary" bindtap="contactService">
        è”ç³»å®¢æœ
      </button>
      <button 
        class="action-button primary" 
        disabled="{{ !canRenew }}"
        bindtap="startRenewal"
      >
        ç«‹å³ç»­è´¹
      </button>
    </view>
  </view>
</view>